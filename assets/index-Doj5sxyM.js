var A=Object.defineProperty;var W=(a,t,e)=>t in a?A(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var s=(a,t,e)=>W(a,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=e(i);fetch(i.href,r)}})();const F=Symbol(),M=Object.getPrototypeOf,x=new WeakMap,H=a=>a&&(x.has(a)?x.get(a):M(a)===Object.prototype||M(a)===Array.prototype),z=a=>H(a)&&a[F]||null,k={},P=a=>typeof a=="object"&&a!==null,R=a=>P(a)&&!O.has(a)&&(Array.isArray(a)||!(Symbol.iterator in a))&&!(a instanceof WeakMap)&&!(a instanceof WeakSet)&&!(a instanceof Error)&&!(a instanceof Number)&&!(a instanceof Date)&&!(a instanceof String)&&!(a instanceof RegExp)&&!(a instanceof ArrayBuffer)&&!(a instanceof Promise),X=(a,t,e,n)=>({deleteProperty(i,r){const o=Reflect.get(i,r);e(r);const l=Reflect.deleteProperty(i,r);return l&&n(["delete",[r],o]),l},set(i,r,o,l){const u=!a()&&Reflect.has(i,r),h=Reflect.get(i,r,l);if(u&&(N(h,o)||B.has(o)&&N(h,B.get(o))))return!0;e(r),P(o)&&(o=z(o)||o);const d=!v.has(o)&&K(o)?T(o):o;return t(r,d),Reflect.set(i,r,d,l),n(["set",[r],o,h]),!0}}),v=new WeakMap,O=new WeakSet,q=[1,1],B=new WeakMap;let N=Object.is,Y=(a,t)=>new Proxy(a,t),K=R,U=X;function T(a={}){if(!P(a))throw new Error("object required");const t=B.get(a);if(t)return t;let e=q[0];const n=new Set,i=(p,w=++q[0])=>{e!==w&&(e=w,n.forEach(f=>f(p,w)))};let r=q[1];const o=(p=++q[1])=>(r!==p&&!n.size&&(r=p,u.forEach(([w])=>{const f=w[1](p);f>e&&(e=f)})),e),l=p=>(w,f)=>{const S=[...w];S[1]=[p,...S[1]],i(S,f)},u=new Map,h=(p,w)=>{const f=!O.has(w)&&v.get(w);if(f){if((k?"production":void 0)!=="production"&&u.has(p))throw new Error("prop listener already exists");if(n.size){const S=f[2](l(p));u.set(p,[f,S])}else u.set(p,[f])}},d=p=>{var w;const f=u.get(p);f&&(u.delete(p),(w=f[1])==null||w.call(f))},y=p=>(n.add(p),n.size===1&&u.forEach(([f,S],E)=>{if((k?"production":void 0)!=="production"&&S)throw new Error("remove already exists");const I=f[2](l(E));u.set(E,[f,I])}),()=>{n.delete(p),n.size===0&&u.forEach(([f,S],E)=>{S&&(S(),u.set(E,[f]))})});let c=!0;const g=U(()=>c,h,d,i),L=Y(a,g);B.set(a,L);const D=[a,o,y];return v.set(L,D),Reflect.ownKeys(a).forEach(p=>{const w=Object.getOwnPropertyDescriptor(a,p);"value"in w&&w.writable&&(L[p]=a[p])}),c=!1,L}class V{constructor(t){s(this,"_playerPosition",T({x:47,y:19}));s(this,"_playerQuests");this._playerQuests=t}movePlayer(t,e){var d,y;const n=["sea","river","mountain","tower","building"],i=document.getElementsByClassName("popup-overlay"),r=document.getElementsByClassName(`${this._playerPosition.x}-${this._playerPosition.y}`);let o=this._playerPosition.x+t,l=this._playerPosition.y+e;const u=document.getElementsByClassName(`${o}-${l}`),h=!n.some(c=>{const g=document.getElementsByClassName(`${o}-${l}`);return g[0].classList.contains(c)&&!g[0].classList.contains("quest")});if(console.log(i.length<1),h&&i.length<1){if(this._playerPosition={x:o,y:l},r[0].classList.remove("player"),u[0].classList.add("player"),u[0].classList.contains("quest")&&u[0].classList.contains("mainQuest")){const c=(d=this._playerQuests.questsMap.get(this._playerQuests.currentChapter))==null?void 0:d.find(g=>`${g.questCell.x}-${g.questCell.y}`==`${o}-${l}`);if((c==null?void 0:c.questPriority)==="mainQuest"&&c.nextQuest){const g=`${c.nextQuest.x}-${c.nextQuest.y}`;document.getElementsByClassName(g)[0].classList.add("quest","mainQuest")}console.log(this._playerQuests.currentChapter),c!=null&&c.isFirstQuest&&((y=this._playerQuests.questsMap.get(this._playerQuests.currentChapter))==null||y.forEach(g=>{g.questPriority==="sideQuest"&&document.getElementsByClassName(`${g.questCell.x}-${g.questCell.y}`)[0].classList.add("quest","sideQuest")})),c!=null&&c.isFinalQuest&&(this._playerQuests.currentChapter=this._playerQuests.currentChapter+1),c==null||c.runQuest(),u[0].classList.remove("quest"),u[0].classList.remove("mainQuest")}if(u[0].classList.contains("quest")&&u[0].classList.contains("sideQuest")){const c=[...this._playerQuests.questsMap.values()].reduce((g,L)=>[...g,...L],[]).find(g=>`${g.questCell.x}-${g.questCell.y}`==`${o}-${l}`);if((c==null?void 0:c.questPriority)==="mainQuest"&&c.nextQuest){const g=`${c.nextQuest.x}-${c.nextQuest.y}`;document.getElementsByClassName(g)[0].classList.add("quest","mainQuest")}c==null||c.runQuest(),u[0].classList.remove("quest")}}}get playerPosition(){return this._playerPosition}}class _{constructor(t,e,n,i){s(this,"_elementSet");this._elementSet=new Set(this.generateElement(t,e,i,n))}generateElement(t,e,n,i){let r=[];for(let o=t;o<=e;o++)for(let l=i;l<=n;l++)r.push(`${o}-${l}`);return r}get elementSet(){return this._elementSet}}class J{constructor(){s(this,"_elementSet");s(this,"riverElement1",new _(49,49,14,14));s(this,"riverElement2",new _(47,48,15,15));s(this,"riverElement3",new _(46,46,16,17));s(this,"riverElement4",new _(47,47,18,18));s(this,"riverElement5",new _(46,46,19,19));s(this,"riverElement6",new _(45,45,20,23));s(this,"riverElement7",new _(46,46,24,24));s(this,"riverElement8",new _(47,47,25,28));s(this,"riverElement9",new _(48,48,29,29));s(this,"riverElement10",new _(49,49,30,30));this._elementSet=new Set(this.generateElement())}generateElement(){return[...this.riverElement1.elementSet,...this.riverElement2.elementSet,...this.riverElement3.elementSet,...this.riverElement4.elementSet,...this.riverElement5.elementSet,...this.riverElement6.elementSet,...this.riverElement7.elementSet,...this.riverElement8.elementSet,...this.riverElement9.elementSet,...this.riverElement10.elementSet]}get elementSet(){return this._elementSet}}class C{constructor(t,e){s(this,"_elementSet");this._elementSet=new Set(this.generateElement(t,e))}generateElement(t,e){const[n,i]=t.split("-").map(Number),r=[];for(let o=i-e;o<=i+e;o++)for(let l=n-e;l<=n+e;l++)Math.sqrt((l-n)**2+(o-i)**2)<=e&&r.push(`${l}-${o}`);return r}get elementSet(){return this._elementSet}}class ${constructor(t,e,n,i=0){s(this,"_elementSet");this._elementSet=new Set(this.generateElement(t,e,n,i))}generateElement(t,e,n,i=0){let r=[];for(let o=t;o>=n;o--)for(let l=t-o;l<=e-(t-o);l++)r.push(`${l+i}-${o}`);return r}get elementSet(){return this._elementSet}}class b{constructor(){s(this,"_elementSet");s(this,"_roof",new $(11,6,8));s(this,"_roof2",new $(11,4,6,1));s(this,"_tower",new _(1,5,12,19));this._elementSet=new Set(...this._roof.elementSet)}get elementSet(){return this._elementSet}get roof(){return this._roof}get tower(){return this._tower}get roof2(){return this._roof2}}class j{constructor(t,e,n,i,r){s(this,"_popupTitle");s(this,"_popupContent");s(this,"_popupImage");s(this,"_btnText");s(this,"_onBtnClick");this._popupTitle=t,this._popupContent=e,this._btnText=i,this._onBtnClick=n,this._popupImage=r}create(){const t=document.getElementsByClassName("grid"),e=document.createElement("div"),n=document.createElement("div"),i=document.createElement("div"),r=document.createElement("div"),o=document.createElement("div"),l=document.createElement("img"),u=document.createElement("p"),h=document.createElement("h3"),d=document.createElement("button");e.className="popup-overlay",n.className="popup",i.className="popup-container",h.className="popup-title",r.className="popup-content",o.className="btn-wrapper",u.className="content-text",h.innerHTML=this._popupTitle,u.innerHTML=this._popupContent,d.textContent=this._btnText||"Закрыть",this._popupImage&&(l.src=this._popupImage,r.appendChild(l)),r.appendChild(u),o.appendChild(d),i.appendChild(h),i.appendChild(r),i.appendChild(o),n.appendChild(i),t[0].appendChild(e),t[0].appendChild(n),d.onclick=()=>{t[0].removeChild(e),t[0].removeChild(n),this._onBtnClick&&this._onBtnClick()}}}class m{constructor(t,e,n,i,r,o,l,u,h,d,y){s(this,"_questName");s(this,"_questPriority");s(this,"_questCell");s(this,"_questTitle");s(this,"_questContent");s(this,"_questImg");s(this,"_questHasBeenOpened",!1);s(this,"_nextQuest");s(this,"_isFirstQuest");s(this,"_isFinalQuest");s(this,"_endGameQuest");s(this,"_btnCustomTitle");this._questName=t,this._questCell=e,this._questTitle=n,this._questContent=i,this._questImg=o,this._questPriority=r,this._nextQuest=l,this._isFinalQuest=u,this._isFirstQuest=h,this._endGameQuest=d,this._btnCustomTitle=y}runQuest(){this._questHasBeenOpened||new j(this._questTitle,this._questContent,()=>{this._endGameQuest&&this._endGameQuest.runQuest()},this._btnCustomTitle||"Дальше",this._questImg).create()}get questCell(){return this._questCell}set questCell(t){this._questCell=t}get questContent_1(){return this._questContent}set questContent_1(t){this._questContent=t}get questName(){return this._questName}set questName(t){this._questName=t}get questHasBeenOpened(){return this._questHasBeenOpened}set questHasBeenOpened(t){this._questHasBeenOpened=t}get questPriority(){return this._questPriority}get nextQuest(){return this==null?void 0:this._nextQuest}get isFinalQuest(){return!!this._isFinalQuest}get isFirstQuest(){return this._isFirstQuest}}class Z{constructor(){s(this,"_currentChapter",0);s(this,"endgameQuest",new m("endgame-quest",{x:1,y:1},"Конец истории или начало?","Милая, покая я готовил эту мини игру - в действительности осознал насколько все таки наша встреча и наша история романтичная и это очень круто. Я был уверен, что подобное бывает только в фильмах ахах. Ты восхитительная удивительная и невероятно красивая девушка. Я люблю тебя, и с каждым днем люблю сильнее!","mainQuest","./love.jpg",void 0,void 0,void 0,void 0,"Люблю тебя!"));s(this,"firstMeeting",new m("first-meeting",{x:45,y:22},"Точка отсчёта...","Компания устраивает корпоратив! Наконец-то можно встретиться с коллегами не только в рабочих чатах. А вот и фото отеля… Выглядит стильно, да и говорят, что это последний раз, когда вечеринка пройдёт в Турции. Надо ехать — кто знает, какие сюрпризы ждут впереди?","mainQuest","./hotel.jpeg",{x:23,y:11},!0,!0));s(this,"dogWalking",new m("dog-walking",{x:48,y:17},"Собаки, солнце и хорошее настроение","Миссия выполнена: лапы уставшие, хвосты виляют, а глаза сверкают от счастья! Сосисы довольны, а ты — молодец! Кажется, день начинается с правильных эмоций. Что ждёт впереди?","sideQuest","./dogWalking.jpeg"));s(this,"morningCoffee",new m("morning-coffee",{x:48,y:18},"Завтрак чемпиона","Утро начинается с аромата свежих тостов и горячего чая. На столе лёгкий завтрак — хрустящий круассан, немного ягод и мёд. Первый кусочек — и день сразу кажется уютнее. Теперь можно не спеша насладиться моментом перед суетой дня. Что дальше по плану?","sideQuest","./breakfast.jpeg"));s(this,"earlyArrival",new m("early-arrival",{x:23,y:11},"Первая встреча","Ты приехала раньше всей компании, но, к счастью, не одна. Коллеги из Алматинского офиса тоже уже здесь! Отличный шанс завести новые знакомства и скоротать время в приятной беседе перед тем, как приедут остальные. О, а кто это? Новый парень в компании? Кажется, ты его раньше не встречала…","mainQuest","./cpComming.jpg",{x:30,y:8},!1,!0));s(this,"galaDinner",new m("gala-dinner",{x:30,y:8},"Гала-ужин","Роскошный вечер, музыка, огни софитов и шум голосов. Все наслаждаются концертом, но... Кажется, прямо во время выступления кое-кто посмотрел на тебя голодным взглядом. Совпадение или намёк?","mainQuest","./galaNight1.png",{x:20,y:2}));s(this,"finalDay",new m("fall-in-love",{x:20,y:2},"Это что там, гроза?","Всю ночь ты слушала игру на гитаре и гуляла с ним по берегу. Болтали обо всём на свете, смеялись, делились историями — и так до самого утра. Он смотрел на тебя как-то особенно… Кажется, ты ему понравилась. Жаль, что завтра уезжать. И ты так хочешь, чтобы он запал на тебя.","mainQuest","./pier.jpeg",{x:49,y:16},!0,!1));s(this,"seaSofa",new m("sea-sofa",{x:26,y:5},"Поэкстрималим?","Ну что, поэкстрималим! Побежали на пляж, кататься на диванчике. Конечно, нужно позвать и его. Не то чтобы тебе так важно, но почему-то хочется, чтобы он был рядом. Чтобы смех был громче, ветер сильнее… и чтобы случайные касания не казались такими уж случайными.","sideQuest","./seaSofa.png"));s(this,"listenToGuitar",new m("listen-g",{x:22,y:4},"Я обычно не слушаю музыку","Оу, на пирсе можно послушать гитару. Ты любишь музыку, но редко позволяешь себе её слушать — слишком глубоко цепляет. Но сейчас всё иначе. Он играет, перебирая струны уверенными движениями, а ты сидишь рядом, облокотившись на него спиной. Ветер, весёлая мелодия, его дыхание где-то совсем рядом… И почему-то не хочется двигаться.","sideQuest","./guitar.JPG"));s(this,"cringeGames",new m("cringe-games",{x:24,y:7},"Кринжевые старты","Командный дух, азарт, а ещё немного стыда — кажется, без этого тимбилдинг не бывает. Вас ждут странные конкурсы, нелепые задания и море смеха. Готова ли ты рискнуть своей репутацией ради победы? Или хотя бы ради весёлых фото на память?","sideQuest","./cringeStarts.jpg"));s(this,"backToPrague",new m("trying-to-forget",{x:49,y:16},"Ну и зачем я об этом думаю?","Ты снова дома. Всё должно вернуться в привычное русло: работа, друзья, повседневные заботы… Прошло уже пару недель, и ты пыталась выбросить его из головы. Должно было получиться. Но почему-то не получается. Это что-то новенькое. Телефон вибрирует — новое сообщение. От него.","mainQuest","./instChat.jpg",{x:44,y:22},!1,!0));s(this,"nextParty",new m("next-party",{x:44,y:22},"Новый повод для встречи","Вы переписываетесь, и забыть его уже не получается. Ты даже хотела поехать в Алмату на концерт, но не сложилось. А потом пришла новость: следующий корпоратив будет там! Ты сразу решила — едешь. Кстати, он упомянул, что скоро у него день рождения. Надо бы подумать о подарке.","mainQuest","./almaty.png",{x:30,y:45},!0,!1));s(this,"checkInst",new m("check-instagram",{x:49,y:27},"Просто взгляну и закрою","Ты открываешь Instagram, просто чтобы полистать ленту… и, конечно же, сразу натыкаешься на него. Видео. Он отжимается. Ну да, конечно, зачем-то надо было это выкладывать. Ты почему-то смотришь до конца. Потом ещё раз...","sideQuest","./inst.jpeg"));s(this,"firstOfficeMeeting",new m("first-office-meeting",{x:30,y:45},"Первая встреча в офисе","Неделя в офисе перед корпоративом — ничего сложного, но сегодня день особенный. У него день рождения. Ты подготовилась, выбрала подарок и, наконец, вручила его. Он поблагодарил, улыбнулся... но почему-то не так, как ты ожидала. Ни радости, ни намёка на что-то большее. Или тебе кажется? Неужели всё это было только с твоей стороны?","mainQuest","./firstOfficeMeeting.jpg",{x:28,y:41},!1,!0));s(this,"almatyPartyNight",new m("corporate-evening",{x:28,y:41},"Вечер корпоратива",'Весь вечер ты искала его глазами… и каждый раз ловила на себе его взгляд. Праздничная суета, музыка, лёгкие разговоры — но между вами будто тянется невидимая нить. Позже, уже в офисе, вы с коллегами засели за настолки и играли до самого утра. И тут телефон завибрировал — сообщение. "Не хочешь прогуляться?". Ночная улица, лёгкий ветер, тихий разговор. А дальше… вы поехали к нему. Ты спала всего пару часов, но ночь была восхитительной.',"mainQuest","./partyNight.jpg",{x:31,y:45},!1,!1));s(this,"lastOfficeDay",new m("last-office-day",{x:31,y:45},"Последний день в офисе","Работа? Какая работа. Вы то и дело выбегаете вместе на перекур, шутите, украдкой целуетесь, скрываясь от лишних глаз. В какой-то момент становится ясно, что оставаться в офисе просто бессмысленно. Вы сбегаете, чтобы провести вместе весь остаток дня. А потом… аэропорт. Он поехал с тобой и оставался рядом до последнего момента. Раньше тебя никто так не провожал.","mainQuest","./lastDay.jpg",{x:48,y:23},!0));s(this,"birthdayNight",new m("birthday-night",{x:41,y:42},"День рождения","Ты пошла к нему на день рождения. Было весело: один бар, потом другой, а потом как-то незаметно вы оказались в караоке. Музыка, смех, громкие разговоры — тусовка удалась. А ещё утром он позвал тебя кататься на сноуборде. Как же мы встанем ахах.","sideQuest","./bDay.jpg"));s(this,"snowboardingDay",new m("snowboarding-day",{x:21,y:44},"Горы, снег и первая попытка","Вы поехали в горы кататься на сноуборде. Ты впервые встала на доску — неуклюже, с падениями, но с каким же азартом. Вокруг всё белоснежное, воздух свежий, пейзажи захватывают дух. Ты так соскучилась по снегу, что даже холодный ветер кажется приятным. Отличный день.","sideQuest","./snowboarding.jpeg"));s(this,"concert",new m("concert",{x:35,y:47},"Новый звук",'Он позвал тебя на концерт группы "Заточка". Ты ни разу её не слышала и вообще так давно не была на концертах. Громкий звук, толпа, вибрация басов в воздухе — тебя затянуло с первых минут. А на следующий день ты уже слушала их на повторе. Кажется, что-то в этом зацепило.',"sideQuest","./zatochka.jpg"));s(this,"gladiatorMovie",new m("gladiator-movie",{x:35,y:43},"Кино или комедия?",'Вы решили сходить в кино на "Гладиатор 2". Ожидали эпичное зрелище, но получили... ну, что-то совсем не то. Фильм оказался таким кринжовым, что вы просто не могли перестать смеяться. Этих педиковатых братьев и обезьянку вы ещё долго будете вспоминать. Кажется, зрители вокруг вас не разделяли этого настроения, но вас это не остановило. После кино вы пошли в бар в отеле и просидели там до 4-х утра, вспоминая самые нелепые моменты фильма и угорая над всем подряд. Один из самых смешных и лёгких вечеров.',"sideQuest","./gladiator.png"));s(this,"homecoming",new m("homecoming",{x:48,y:23},"Возвращение домой","Ты снова дома. Самолёт приземлился, всё вокруг привычное, но внутри всё иначе. В аэропорту вы договорились созвониться и обсудить отношения, но чем больше ты об этом думаешь, тем больше сомнений. Это точно возможно? Или лучше остановиться, пока не стало слишком поздно? Но ведь так хочется просто нырнуть в эту влюблённость…","mainQuest","./homeComming.jpeg",{x:42,y:24},!1,!0));s(this,"relationshipDecision",new m("relationship-decision",{x:42,y:24},"День X","Вы заранее договорились созвониться, и вот момент настал. Никаких колебаний — ты уже всё решила. Вы оба знаете, чего хотите, и теперь это официально — у тебя есть парень. А через пару недель вас ждёт первая поездка. Ура, вы летите в Стамбул!","mainQuest","./dayX.jpeg",{x:13,y:15},!0,!1));s(this,"newYearNight",new m("new-year-night",{x:47,y:23},"Новогодняя ночь","Вы созваниваетесь, болтаете обо всём и поздравляете друг друга с Новым годом. Вроде бы ничего особенного, но внутри тепло. А потом начинается самое сложное — твои бедные собаки в панике от салютов. Всю ночь ты их успокаиваешь, играешь с ними, отвлекаешь, и, наконец, они перестают тревожиться. Под утро в доме наступает тишина, и ты наконец-то засыпаешь. Отличный старт года.","sideQuest","./newYear.jpeg"));s(this,"istanbulArrival",new m("istanbul-arrival",{x:13,y:15},"Долгожданная поездка","Наконец-то Стамбул… почти. Самолёт задержали, и теперь всё пошло не по плану — ты должна была прилететь первой, но теперь он уже ждёт тебя в аэропорту. Волнение? Да. Но больше всего — нетерпение. А он уже прилетел и бомбит тебя кружочками. Кажется, ждёт не меньше твоего.","mainQuest","./istArrival.jpg",{x:7,y:15},!0,!0));s(this,"finalConfession",new m("final-confession",{x:7,y:15},"Восхитительное утро",'Это была невероятная поездка. Город, эмоции, и главное — он рядом. Ты счастлива. И ты уверена, что он тоже. Утро медленно пробирается сквозь шторы, вы оба ещё не до конца проснулись, но чувствуете тепло друг друга. Ты очень хочешь сказать эти слова… и наконец говоришь: "Я тебя люблю". Он смотрит на тебя, улыбается и отвечает: "Я тоже тебя люблю".',"mainQuest","./morning-love.jpg",void 0,!0,!0,this.endgameQuest));s(this,"bosphorusWalk",new m("bosphorus-walk",{x:3,y:6},"Прогулка у Босфора","Вы идёте вдоль набережной, ветер с пролива приятно холодит кожу, вечерние огни отражаются в воде. Город шумит вокруг, но вы в своём мире — смеётесь, болтаете обо всём и никуда не спешите. Всё просто и прекрасно.","sideQuest","./bosphorus.jpg"))}get questsMap(){return new Map([[0,[this.firstMeeting,this.dogWalking,this.morningCoffee]],[1,[this.galaDinner,this.finalDay,this.earlyArrival,this.listenToGuitar,this.seaSofa,this.cringeGames]],[2,[this.backToPrague,this.checkInst,this.nextParty]],[3,[this.firstOfficeMeeting,this.almatyPartyNight,this.lastOfficeDay,this.snowboardingDay,this.birthdayNight,this.concert,this.gladiatorMovie]],[4,[this.homecoming,this.relationshipDecision,this.newYearNight]],[5,[this.istanbulArrival,this.bosphorusWalk]],[6,[this.finalConfession]]])}get currentChapter(){return this._currentChapter}set currentChapter(t){this._currentChapter=t}}class G{constructor(){s(this,"mountain1",new $(49,10,44,1));s(this,"mountain2",new $(49,12,43));s(this,"mountain3",new $(49,8,45,2));s(this,"mountain4",new $(49,6,45,3));s(this,"mountain5",new $(49,18,40,3));s(this,"mountain6",new $(49,16,41,4));s(this,"mountain7",new $(49,14,42,5));s(this,"mountain8",new $(49,12,43,6));s(this,"mountain9",new $(49,10,44,15));s(this,"mountain10",new $(49,8,43,16));s(this,"mountain11",new $(49,6,44,17));s(this,"mountain12",new $(49,4,45,18))}renderMountains(t,e,n){this.mountain5.elementSet.has(`${e}-${n}`)&&(t.classList.add("mountain"),t.classList.add("mountain5")),this.mountain6.elementSet.has(`${e}-${n}`)&&(t.classList.add("mountain"),t.classList.add("mountain6")),this.mountain7.elementSet.has(`${e}-${n}`)&&(t.classList.add("mountaint"),t.classList.add("mountain7")),this.mountain8.elementSet.has(`${e}-${n}`)&&(t.classList.add("mountaint"),t.classList.add("mountain8")),this.mountain1.elementSet.has(`${e}-${n}`)&&(t.classList.add("mountain"),t.classList.add("mountain1")),this.mountain2.elementSet.has(`${e}-${n}`)&&(t.classList.add("mountain"),t.classList.add("mountain2")),this.mountain3.elementSet.has(`${e}-${n}`)&&(t.classList.add("mountaint"),t.classList.add("mountain3")),this.mountain4.elementSet.has(`${e}-${n}`)&&(t.classList.add("mountaint"),t.classList.add("mountain4")),this.mountain9.elementSet.has(`${e}-${n}`)&&(t.classList.add("mountain"),t.classList.add("mountain9")),this.mountain10.elementSet.has(`${e}-${n}`)&&(t.classList.add("mountain"),t.classList.add("mountain10")),this.mountain11.elementSet.has(`${e}-${n}`)&&(t.classList.add("mountaint"),t.classList.add("mountain11")),this.mountain12.elementSet.has(`${e}-${n}`)&&(t.classList.add("mountaint"),t.classList.add("mountain12"))}}class ee{constructor(){s(this,"_cityMap",new Map);s(this,"_buildings",[]);this.generateBuildings()}generateBuildings(){const t=new Set,e=(n,i,r,o,l)=>{for(let d=n-1;d<=i+1;d++)for(let y=r-1;y<=o+1;y++)if(t.has(`${d}-${y}`))return;const u=new _(n,i,r,o),h=[...u.elementSet];this._buildings.push(u),h.forEach(d=>t.add(d)),h.forEach(d=>this._cityMap.set(d,{type:l,width:i-n+1,height:o-r+1}))};e(30,31,43,45,"bigBuilding"),e(27,28,41,42,"mediumBuilding"),e(34,35,46,47,"mediumBuilding"),e(39,40,42,43,"mediumBuilding"),e(31,32,46,47,"mediumBuilding"),e(37,38,41,42,"mediumBuilding"),e(29,29,41,41,"smallBuilding"),e(26,26,44,44,"smallBuilding"),e(26,26,46,46,"smallBuilding"),e(26,26,48,48,"smallBuilding"),e(32,32,44,44,"smallBuilding"),e(37,37,47,47,"smallBuilding"),e(41,41,45,45,"smallBuilding"),e(28,28,44,44,"smallBuilding"),e(35,35,43,43,"smallBuilding"),e(40,40,46,46,"smallBuilding")}renderCity(t,e,n){const i=`${e}-${n}`;if(this._cityMap.has(i)){const{type:r}=this._cityMap.get(i);t.classList.add("building"),t.classList.add(r)}}}class te{constructor(){s(this,"_circle",new C("38-46",16));s(this,"_circle2",new C("38-46",14));s(this,"_circle3",new C("38-46",10));s(this,"_mountains",new G);s(this,"_snowCity",new ee)}render(t,e,n){this._circle.elementSet.has(`${e}-${n}`)&&t.classList.add("snow"),this._circle2.elementSet.has(`${e}-${n}`)&&t.classList.add("snow1"),this._circle3.elementSet.has(`${e}-${n}`)&&t.classList.add("snow2"),this._mountains.renderMountains(t,e,n),this._snowCity.renderCity(t,e,n)}}class se{constructor(){s(this,"grass",new C("46-23",12));s(this,"grass2",new C("46-23",10));s(this,"grass3",new C("46-23",6))}render(t,e,n){this.grass.elementSet.has(`${e}-${n}`)&&t.classList.add("grass"),this.grass2.elementSet.has(`${e}-${n}`)&&t.classList.add("grass2"),this.grass3.elementSet.has(`${e}-${n}`)&&t.classList.add("grass3")}}class ne{constructor(){s(this,"_grass",new se);s(this,"_cityMap",new Map);s(this,"_buildings",[]);this.generateBuildings()}generateBuildings(){const t=new Set,e=(n,i,r,o,l)=>{for(let d=n-1;d<=i+1;d++)for(let y=r-1;y<=o+1;y++)if(t.has(`${d}-${y}`))return;const u=new _(n,i,r,o),h=[...u.elementSet];this._buildings.push(u),h.forEach(d=>t.add(d)),h.forEach(d=>this._cityMap.set(d,{type:l,width:i-n+1,height:o-r+1}))};e(41,42,21,24,"bigBuilding"),e(47,48,23,24,"mediumBuilding"),e(47,47,19,19,"smallBuilding")}render(t,e,n){this._grass.render(t,e,n);const i=`${e}-${n}`;if(this._cityMap.has(i)){const{type:r}=this._cityMap.get(i);t.classList.add("building"),t.classList.add(r),t.classList.add("green")}}}class ie{constructor(){s(this,"_asphalt",new C("3-15",12));s(this,"_asphalt2",new C("3-15",10));s(this,"_asphalt3",new C("3-15",6));s(this,"_cityMap",new Map);s(this,"_buildings",[]);s(this,"_tower",new b);this.generateBuildings()}generateBuildings(){const t=new Set,e=(n,i,r,o,l)=>{for(let d=n-1;d<=i+1;d++)for(let y=r-1;y<=o+1;y++)if(t.has(`${d}-${y}`))return;const u=new _(n,i,r,o),h=[...u.elementSet];this._buildings.push(u),h.forEach(d=>t.add(d)),h.forEach(d=>this._cityMap.set(d,{type:l,width:i-n+1,height:o-r+1}))};e(9,11,9,10,"bigBuilding"),e(7,8,14,15,"mediumBuilding"),e(1,1,7,7,"smallBuilding"),e(5,5,7,7,"smallBuilding"),e(9,9,7,7,"smallBuilding")}render(t,e,n){this._asphalt.elementSet.has(`${e}-${n}`)&&t.classList.add("asphalt"),this._asphalt2.elementSet.has(`${e}-${n}`)&&t.classList.add("asphalt2"),this._asphalt3.elementSet.has(`${e}-${n}`)&&t.classList.add("asphalt3"),this._tower.tower.elementSet.has(`${e}-${n}`)&&t.classList.add("towerBody","tower"),this._tower.roof.elementSet.has(`${e}-${n}`)&&t.classList.add("roof","tower"),this._tower.roof2.elementSet.has(`${e}-${n}`)&&t.classList.add("roof2","tower");const i=`${e}-${n}`;if(this._cityMap.has(i)){const{type:r}=this._cityMap.get(i);t.classList.add("building"),t.classList.add(r),t.classList.add("gray")}}}class ae{constructor(){s(this,"gridSize",50);s(this,"grid",document.getElementById("grid"));s(this,"pier",new _(20,22,2,6));s(this,"sand",new _(0,49,5,9));s(this,"quests",new Z);s(this,"player",new V(this.quests));s(this,"mountains",new G);s(this,"winterCity",new te);s(this,"river",new J);s(this,"greenCity",new ne);s(this,"grayCity",new ie);s(this,"beachGrass",new C("30-8",2));s(this,"bridge",new _(44,46,22,22));s(this,"towerRoof",new b().roof);s(this,"tower",new b().tower);s(this,"welcomeQuest",new j("Привет, милашка! Готова отправиться в захватывающее приключение, полное неожиданных встреч и искренних эмоций?","Это история о чувствах, судьбе и маленьких случайностях, которые могут изменить всё... Но помни: всё здесь – лишь плод воображения, а любые совпадения – чистая случайность. Или нет?",void 0,"Готова!","wellcome.jpg"))}createGrid(){var t;this.grid.innerHTML="";for(let e=0;e<this.gridSize;e++)for(let n=0;n<this.gridSize;n++){const i=document.createElement("div");i.classList.add("cell"),this.grid.appendChild(i),i.classList.add(`${n}-${e}`),this.sand.elementSet.has(`${n}-${e}`)&&i.classList.add("sand"),this.pier.elementSet.has(`${n}-${e}`)&&(i.classList.add("pier"),i.classList.remove("sea")),this.beachGrass.elementSet.has(`${n}-${e}`)&&i.classList.add("grass"),(e===0||e===1||e===2||e===3||e===4||e===5&&n%2)&&(i.classList.contains("pier")||i.classList.add("sea")),this.mountains.renderMountains(i,n,e),this.winterCity.render(i,n,e),this.greenCity.render(i,n,e),this.grayCity.render(i,n,e),n===this.player.playerPosition.x&&e===this.player.playerPosition.y&&i.classList.add("player"),(t=this.quests.questsMap.get(0))==null||t.forEach(r=>{`${r.questCell.x}-${r.questCell.y}`==`${n}-${e}`&&(i.classList.add("quest"),i.classList.add(`${r.questName}`),i.classList.add(`${r.questPriority}`))}),this.river.elementSet.has(`${n}-${e}`)&&i.classList.add("river"),this.bridge.elementSet.has(`${n}-${e}`)&&(i.classList.remove("river"),i.classList.add("bridge")),this.tower.elementSet.has(`${n}-${e}`)&&i.classList.add("towerBody","tower"),this.towerRoof.elementSet.has(`${n}-${e}`)&&i.classList.add("roof","tower")}this.welcomeQuest.create()}}const Q=new ae;Q.createGrid();document.addEventListener("keydown",a=>{(a.key==="a"||a.key==="ф"||a.key==="ArrowLeft")&&Q.player.movePlayer(-1,0),(a.key==="d"||a.key==="в"||a.key==="ArrowRight")&&Q.player.movePlayer(1,0),(a.key==="w"||a.key==="ц"||a.key==="ArrowUp")&&Q.player.movePlayer(0,-1),(a.key==="s"||a.key==="ы"||a.key==="ArrowDown")&&Q.player.movePlayer(0,1)});
